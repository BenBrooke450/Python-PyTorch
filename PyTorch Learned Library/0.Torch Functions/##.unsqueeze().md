
In PyTorch, the `unsqueeze()` function is used to add a dimension to a tensor at a specified position. This operation is particularly useful when you need to change the shape of a tensor to meet the requirements of certain operations or functions that expect inputs with a specific number of dimensions.

### Summary of `unsqueeze()`

- **Purpose:** Adds a dimension of size one at a specified position in the tensor.

- **Usage:** You can call the `.unsqueeze()` method on a PyTorch tensor.

- **Syntax:**
  ```python
  tensor.unsqueeze(dim)
  ```
  or alternatively,
  ```python
  torch.unsqueeze(tensor, dim)
  ```

- **Parameters:**
  - `dim`: The index at which the new dimension will be inserted. It can be negative for indexing from the end (e.g., `-1` refers to the last position).

- **Returns:** A new tensor with the added dimension.

### Key Points

- **Dimension Indexing:** The `dim` parameter specifies where the new dimension will be added. For example, `dim=0` adds a new dimension at the beginning, and `dim=1` adds it at the second position.

- **Negative Indexing:** You can use negative values for `dim` to index from the end of the tensor's shape. For example, `dim=-1` adds a dimension at the last position.

- **No Data Copy:** The `unsqueeze()` operation does not copy the tensor data; it simply changes the view of the tensor to include an additional dimension.

### Examples of `unsqueeze()`

Here are some examples demonstrating how to use `unsqueeze()` in PyTorch:

```python
import torch

# Example 1: Unsqueeze a 1D tensor to a 2D tensor
tensor1 = torch.tensor([1, 2, 3])
unsqueezed_tensor1 = tensor1.unsqueeze(0)  # Shape becomes [1, 3]
print("Unsqueezed Tensor (dim=0):\n", unsqueezed_tensor1)
"""
Unsqueezed Tensor (dim=0):
 tensor([[1, 2, 3]])
"""



unsqueezed_tensor2 = tensor1.unsqueeze(1)  # Shape becomes [3, 1]
print("Unsqueezed Tensor (dim=1):\n", unsqueezed_tensor2)
"""
Unsqueezed Tensor (dim=1):
 tensor([[1],
        [2],
        [3]])
"""



# Example 2: Unsqueeze a 2D tensor to a 3D tensor
tensor2 = torch.tensor([[1, 2], [3, 4]])
unsqueezed_tensor3 = tensor2.unsqueeze(0)  # Shape becomes [1, 2, 2]
print("Unsqueezed 2D Tensor (dim=0):\n", unsqueezed_tensor3)
"""
Unsqueezed 2D Tensor (dim=0):
 tensor([[[1, 2],
         [3, 4]]])
"""



unsqueezed_tensor4 = tensor2.unsqueeze(2)  # Shape becomes [2, 2, 1]
print("Unsqueezed 2D Tensor (dim=2):\n", unsqueezed_tensor4)
"""
Unsqueezed 2D Tensor (dim=2):
 tensor([[[1],
         [2]],

        [[3],
         [4]]])
"""



# Example 3: Using negative indexing
unsqueezed_tensor5 = tensor1.unsqueeze(-1)  # Shape becomes [3, 1]
print("Unsqueezed Tensor (dim=-1):\n", unsqueezed_tensor5)
"""
Unsqueezed Tensor (dim=-1):
 tensor([[1],
        [2],
        [3]])
"""
```

### Explanation of the Examples

- **Example 1:** Converts a 1D tensor to a 2D tensor by adding a dimension at index `0` or `1`.

- **Example 2:** Converts a 2D tensor to a 3D tensor by adding a dimension at index `0` or `2`.

- **Example 3:** Uses negative indexing to add a dimension at the last position, converting a 1D tensor to a 2D tensor.

The `unsqueeze()` function is a versatile tool for reshaping tensors, especially when preparing data for operations that require specific input dimensions.